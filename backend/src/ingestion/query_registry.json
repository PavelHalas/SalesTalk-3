[
  {
    "id": "metric_point_lookup",
    "description": "Fetch single value for a specific period (e.g. Revenue in Q3)",
    "match": {
      "intents": ["what", "compare"],
      "subjects": ["revenue", "margin", "cost", "aov", "units_sold", "orders", "customers", "marketing", "sales", "profit", "inventory", "stock", "products", "regions", "channels", "segments", "reps", "productLines"],
      "dimensions": ["time"]
    },
    "dynamodb": {
      "table": "metrics",
      "pk": "METRIC#{metric}",
      "sk": "{time.period}",
      "query_type": "query",
      "filter_strategy": "expression"
    }
  },
  {
    "id": "metric_trend_analysis",
    "description": "Fetch values over a specified time window (e.g. Year, Quarter) to show trend",
    "match": {
      "intents": ["trend", "forecast"],
      "subjects": ["revenue", "margin", "cost", "aov", "units_sold", "orders", "customers", "marketing", "sales", "profit", "inventory", "stock"],
      "dimensions": ["time", "region", "segment", "channel", "productLine", "status", "timeOfWeek", "device", "planTier", "churnReason", "stage", "competitor", "landingPage", "experiment"]
    },
    "dynamodb": {
      "table": "metrics",
      "pk": "METRIC#{metric}",
      "sk_prefix": "{time.year}",
      "query_type": "query",
      "filter_strategy": "expression"
    }
  },
  {
    "id": "dimensional_breakdown",
    "description": "Break down a metric by a dimension (e.g. Revenue by Region)",
    "match": {
      "intents": ["drill", "breakdown", "compare", "what"],
      "subjects": ["revenue", "margin", "cost", "aov", "units_sold", "orders", "customers", "marketing", "sales", "profit", "products", "regions", "channels", "segments", "reps", "productLines"],
      "dimensions": ["time", "region", "customer", "product", "segment", "channel", "productLine", "status", "timeOfWeek", "device", "planTier", "churnReason", "stage", "competitor", "landingPage", "experiment", "breakdown_by"]
    },
    "dynamodb": {
      "table": "metrics",
      "pk": "METRIC#{metric}",
      "sk_prefix": "{time.period}#",
      "query_type": "query",
      "filter_strategy": "expression"
    }
  },
  {
    "id": "metric_ranking_by_dimension",
    "description": "Rank a dimension by a metric (e.g. Top Customers by Revenue)",
    "match": {
      "intents": ["rank", "top"],
      "subjects": ["revenue", "margin", "cost", "aov", "units_sold", "orders", "customers", "marketing", "sales", "profit"],
      "dimensions": ["time", "customer", "product", "region", "category", "segment", "channel", "productLine", "rep", "competitor", "limit", "direction"]
    },
    "dynamodb": {
      "table": "metrics",
      "pk": "METRIC#{metric}",
      "sk_prefix": "{time.period}#",
      "query_type": "query",
      "post_process": "sort_desc"
    }
  },
  {
    "id": "metric_period_ranking",
    "description": "Rank time periods by metric (e.g. Which month had highest revenue)",
    "match": {
      "intents": ["rank", "top"],
      "subjects": ["revenue", "margin", "cost", "aov", "units_sold", "orders", "customers", "marketing", "sales", "profit", "timePeriods"],
      "dimensions": ["time", "window"]
    },
    "dynamodb": {
      "table": "metrics",
      "pk": "METRIC#{metric}",
      "sk_prefix": "{time.year}",
      "query_type": "query",
      "post_process": "sort_desc"
    }
  },
  {
    "id": "inventory_aging",
    "description": "List inventory items by age",
    "match": {
      "intents": ["list", "what"],
      "subjects": ["inventory", "stock"],
      "dimensions": ["age"]
    },
    "dynamodb": {
      "table": "metrics",
      "pk": "METRIC#inventory_value",
      "sk_prefix": "AGING",
      "query_type": "query"
    }
  },
  {
    "id": "top_entities_ranking",
    "description": "Get top performing entities (e.g. Top 10 Customers)",
    "match": {
      "intents": ["rank", "top"],
      "subjects": ["customers", "products", "regions", "channels", "segments", "reps", "productLines"],
      "dimensions": ["time", "limit", "direction"]
    },
    "dynamodb": {
      "table": "metrics",
      "pk": "METRIC#{metric}", 
      "sk_prefix": "{time.period}#",
      "query_type": "query",
      "post_process": "sort_desc",
      "limit": 10
    }
  },
  {
    "id": "list_entities_by_type",
    "description": "List all entities of a certain type (e.g. List all Customers)",
    "match": {
      "intents": ["list"],
      "subjects": ["customers", "products", "regions", "channels", "segments", "reps", "productLines"],
      "dimensions": []
    },
    "dynamodb": {
      "table": "data",
      "index": "EntityTypeIndex",
      "pk": "{subject_singular}", 
      "query_type": "query"
    }
  },
  {
    "id": "entity_profile_lookup",
    "description": "Get details for a specific entity (e.g. Customer Profile)",
    "match": {
      "intents": ["what", "profile"],
      "subjects": ["customer", "product"],
      "dimensions": ["id"]
    },
    "dynamodb": {
      "table": "data",
      "pk": "{subject_upper}#{dimension.id}",
      "sk": "PROFILE",
      "query_type": "get_item"
    }
  },
  {
    "id": "entity_search_by_name",
    "description": "Find entity by name (e.g. Find customer Acme)",
    "match": {
      "intents": ["find", "search"],
      "subjects": ["customer", "product"],
      "dimensions": ["name"]
    },
    "dynamodb": {
      "table": "data",
      "index": "NameIndex",
      "pk": "{subject_singular}",
      "sk": "{dimension.name}",
      "query_type": "query"
    }
  },
  {
    "id": "child_entities_lookup",
    "description": "Find child entities (e.g. Orders for Customer X)",
    "match": {
      "intents": ["list", "history"],
      "subjects": ["orders"],
      "dimensions": ["customer_id"]
    },
    "dynamodb": {
      "table": "data",
      "index": "ParentIndex",
      "pk": "{dimension.customer_id}",
      "query_type": "query"
    }
  },
  {
    "id": "anomaly_detection",
    "description": "Detect anomalies in metrics",
    "match": {
      "intents": ["anomaly", "why"],
      "subjects": ["revenue", "margin", "cost", "aov", "units_sold", "orders", "customers", "marketing", "sales", "profit"],
      "dimensions": ["time", "region", "segment", "channel", "productLine"]
    },
    "dynamodb": {
      "table": "metrics",
      "pk": "METRIC#{metric}",
      "sk_prefix": "{time.year}",
      "query_type": "query",
      "filter_strategy": "expression"
    }
  },
  {
    "id": "target_tracking",
    "description": "Check if metrics are on track to hit targets",
    "match": {
      "intents": ["target"],
      "subjects": ["revenue", "margin", "cost", "aov", "units_sold", "orders", "customers", "marketing", "sales", "profit"],
      "dimensions": ["time", "region", "segment", "channel", "productLine"]
    },
    "dynamodb": {
      "table": "metrics",
      "pk": "METRIC#{metric}",
      "sk": "{time.period}",
      "query_type": "query",
      "filter_strategy": "expression"
    }
  },
  {
    "id": "correlation_analysis",
    "description": "Analyze correlation between metrics",
    "match": {
      "intents": ["correlation"],
      "subjects": ["revenue", "margin", "cost", "aov", "units_sold", "orders", "customers", "marketing", "sales", "profit"],
      "dimensions": ["time", "related_metric", "region", "segment", "channel", "productLine"]
    },
    "dynamodb": {
      "table": "metrics",
      "pk": "METRIC#{metric}",
      "sk_prefix": "{time.year}",
      "query_type": "query",
      "filter_strategy": "expression"
    }
  }
]
